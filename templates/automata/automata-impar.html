{% extends 'base/base.html' %}
{% load staticfiles %}


{% block title %} Aut贸mata Impar {% endblock %}

{% block content %}
	
	{% for a in automata %}
		<div class="container">
			<br>
			<div class="row">
				<div class="col s12 l8">
					<h4>{{ a.name }}</h4>
					<big>{{ a.description }}</big><br><br>
					<!-- <form method='GET' action=""> -->
						<div class="col s8 m6">
							<div class="input-field">
								<!-- <i class="material-icons prefix">account_circle</i> -->
								<input type="text" name="expression" id="expression"  data-length="20" maxlength="20" required>
								<label for="expression">Expresi贸n</label>
							</div>
						</div>
						<div class="col s4 m2">
							<div class="input-field">
								<!-- <input type="submit" class="btn waves-effect waves-light" id="submit" value="Validar"></input> -->
								<button class="btn waves-effect waves-light" id="submit">Validar</button>
							</div>
						</div>
					<!-- </form> -->
					
				</div>
				<div class="col s12 l4">	
					<div class="card-panel z-depth-2 hoverable" style="padding: 5px;">
						<center><big><b>Ejemplos</b></big></center>
						<table class="highlight responsive-table centered">
							<thead>
								<th>Aceptadas</th>
								<th>No aceadas</th>
							</thead>
							<tbody>
								<tr>
									<td>abcba</td>
									<td>abcab</td>
								</tr>
								<tr>
									<td>abbcbba</td>
									<td>abbbba</td>
								</tr>
							</tbody>
						</table>
						
					</div>
				</div>
			</div>
		{% if expression %}
			<div class="row">
				<div class="col m12 l8">
					<div class="card-panel center-align grey lighten-2" id="expression-panel">
						<div class="container">
							{% for letter in expression %}
								<span class="letter">{{ letter }}</span>
							{% endfor %}
						</div>
						<div id="resultado-automata"></div>
					</div>
				</div>
			</div>
		{% endif %}

		<div class="row">
			<div class="col s12 l8">				
				<div id="grafoAutomata">
					<big id="titulo-grafo">Grafo del Aut贸mata</big>
					<!-- estados -->
					<div class="state valign-wrapper" id="state-p">
						<div class="container center-align">p</div>
					</div>
					<div class="state valign-wrapper" id="state-q">
						<div class="container center-align">q</div>
					</div>
					<div class="state valign-wrapper" id="state-r">
						<div class="center-align" style="width: 100%;">
							<center><div class="acceptance-status">r</div></center>
						</div>
					</div>
					
					<!-- transiciones -->
					<div class="transition-line" id="transition-0"></div>
					<i class="material-icons t-arrow" id="t0-arrow">arrow_drop_down</i>

					<div class="transition-circle" id="transition-1"></div>
					<i class="material-icons t-arrow" id="t1-arrow">arrow_drop_down</i>
					<div class="transition-text" id="transition-text-1">
						<span id="t1-r1">b, b / bb</span> <br>
						<span id="t1-r2">a, b / ba</span> <br>
						<span id="t1-r3">b, a / ab</span> <br>
						<span id="t1-r4">a, a / aa</span> <br>
						<span id="t1-r5">b, # / #b</span> <br>
						<span id="t1-r6">a, # / #a</span>
					</div>

					<div class="transition-line" id="transition-2"></div>
					<i class="material-icons t-arrow" id="t2-arrow">arrow_drop_down</i>
					<div class="transition-text" id="transition-text-2">
						<span id="t2-r1">c, # / # </span><br>
						<span id="t2-r2">c, b / b</span> <br>
						<span id="t2-r3">c, a / a </span>
					</div>

					<div class="transition-circle" id="transition-3"></div>
					<i class="material-icons t-arrow" id="t3-arrow">arrow_drop_down</i>
					<div class="transition-text" id="transition-text-3">
						<span id="t3-r1">b, b / &lambda;</span> <br>
						<span id="t3-r2">a, a / &lambda;</span>
					</div>

					<div class="transition-line" id="transition-4"></div>
					<i class="material-icons t-arrow" id="t4-arrow">arrow_drop_down</i>
					<div class="transition-text" id="transition-text-4">
						<span id="t4-r1">&lambda;, # / #</span>
					</div>
				</div>		
			</div>
			<div class="col s12 l4">
				<div id="pilaAutomata" class="center-align">
					<h5>Pila del Aut贸mata</h5>
					<center>
						<div id="borde-pila">
							<div class="posicion" id="posicion-4"></div>
							<div class="posicion" id="posicion-3"></div>
							<div class="posicion" id="posicion-2"></div>
							<div class="posicion" id="posicion-1">#</div>
						</div>
					</center>
				</div>
			</div>
		</div>
			
		</div>


	{% empty %}	
		<h4>Upps, No encontramos lo que buscabas :(</h4>

	{% endfor %}
	

{% endblock %}

{% block extrahead %}
	<link rel="stylesheet" href="{% static 'css/automata-styles.css' %}">
{% endblock %}

	
{% block extrajs %}
	<script type="text/javascript">
		$(document).ready(function() {
		    $('input#expresion').characterCounter();

		    $('#submit').click(function(){
		    	expression = $('#expression').val();
		    	if (expression != ''){
		    		alert(expression);
		    		location.href = "expresision/"+expression;
		    	}else{
		    		Materialize.toast('Debe ingresar una expresion!', 4000)
		    	}
		    });

		    {% if expression %}
		    	var expression = '';
			    {% for letter in expression %}
			    	expression = expression +"{{letter}}";
			    {% endfor %}

			    $('#expression').val(expression);

		    	Materialize.toast("Se evaluara la expresion \""+expression+"\"", 4000)
		    {% endif %}

		    {% if result %}
				$('#resultado-automata').text("Expresion Aceptada");
				$('#resultado-automata').parent().addClass('teal-text');
			{% else %}
				$('#resultado-automata').text("Expresion No ceptada");
				$('#resultado-automata').parent().addClass('red-text');
					
			{% endif%}



		});
		
	</script>
{% endblock %}
